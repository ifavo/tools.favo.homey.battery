{
  "id": "kostal-battery",
  "name": {
    "en": "Kostal Battery"
  },
  "class": "solarpanel",
  "capabilities": [
    "onoff",
    "measure_battery",
    "measure_power",
    "measure_voltage",
    "measure_current",
    "next_charging_times",
    "last_api_update"
  ],
  "capabilitiesOptions": {
    "onoff": {
      "title": {
        "en": "Grid Charging",
        "de": "Netzladung"
      }
    },
    "measure_battery": {
      "title": {
        "en": "State of Charge",
        "de": "Ladezustand"
      },
      "units": {
        "en": "%"
      }
    },
    "measure_power": {
      "title": {
        "en": "Battery Power",
        "de": "Batterieleistung"
      },
      "units": {
        "en": "W"
      }
    },
    "measure_voltage": {
      "title": {
        "en": "Battery Voltage",
        "de": "Batteriespannung"
      },
      "units": {
        "en": "V"
      }
    },
    "measure_current": {
      "title": {
        "en": "Battery Current",
        "de": "Batteriestrom"
      },
      "units": {
        "en": "A"
      }
    },
    "next_charging_times": {
      "title": {
        "en": "Next Charging Times",
        "de": "Nächste Ladezeiten"
      }
    },
    "last_api_update": {
      "title": {
        "en": "Last Settings Update",
        "de": "Letzte Einstellungsänderung"
      }
    }
  },
  "images": {
    "small": "/drivers/kostal-battery/assets/images/small.svg",
    "large": "/drivers/kostal-battery/assets/images/large.svg",
    "xlarge": "/drivers/kostal-battery/assets/images/xlarge.svg"
  },
  "settings": [
    {
      "type": "group",
      "label": {
        "en": "Connection",
        "de": "Verbindung"
      },
      "children": [
        {
          "id": "ip",
          "type": "text",
          "label": {
            "en": "Inverter IP Address",
            "de": "Wechselrichter IP-Adresse"
          },
          "value": "",
          "hint": {
            "en": "IP address of your Kostal inverter (e.g., 192.168.1.100)"
          }
        },
        {
          "id": "password",
          "type": "password",
          "label": {
            "en": "Password",
            "de": "Passwort"
          },
          "value": "",
          "hint": {
            "en": "Password for the 'user' (Anlagenbetreiber) account"
          }
        },
        {
          "id": "price_timezone",
          "type": "text",
          "label": {
            "en": "Timezone",
            "de": "Zeitzone"
          },
          "value": "",
          "hint": {
            "en": "Timezone for price time formatting (e.g., Europe/Berlin). Leave empty to auto-detect."
          }
        }
      ]
    },
    {
      "type": "group",
      "label": {
        "en": "Charging Settings",
        "de": "Ladeeinstellungen"
      },
      "children": [
        {
          "id": "min_soc",
          "type": "number",
          "label": {
            "en": "Minimum SoC (%)",
            "de": "Minimaler Ladezustand (%)"
          },
          "value": 10,
          "min": 5,
          "max": 100,
          "step": 5,
          "hint": {
            "en": "Battery will not discharge below this level"
          }
        },
        {
          "id": "max_soc",
          "type": "number",
          "label": {
            "en": "Target SoC (%)",
            "de": "Ziel-Ladezustand (%)"
          },
          "value": 80,
          "min": 5,
          "max": 100,
          "step": 5,
          "hint": {
            "en": "Target state of charge when grid charging"
          }
        },
        {
          "id": "watts",
          "type": "number",
          "label": {
            "en": "Charging Power (W)",
            "de": "Ladeleistung (W)"
          },
          "value": 4000,
          "min": 500,
          "max": 10000,
          "hint": {
            "en": "Power to draw from grid for charging"
          }
        }
      ]
    },
    {
      "type": "group",
      "label": {
        "en": "Low Price Charging",
        "de": "Niedrigpreis-Ladung"
      },
      "children": []
    },
    {
      "type": "group",
      "label": {
        "en": "Cheapest Blocks",
        "de": "Günstigste Blöcke"
      },
      "children": [
        {
          "id": "low_price_blocks_count",
          "type": "number",
          "label": {
            "en": "Number of Blocks",
            "de": "Anzahl der Blöcke"
          },
          "value": 8,
          "min": 0,
          "max": 96,
          "hint": {
            "en": "15-min blocks per day set to grid charge. Default: 8 = 2 hours"
          }
        },
        {
          "id": "cheapest_blocks_value",
          "type": "dropdown",
          "label": {
            "en": "Schedule Value",
            "de": "Zeitplanwert"
          },
          "value": "4",
          "values": [
            {
              "id": "0",
              "label": {
                "en": "No restriction",
                "de": "Keine Einschränkung"
              }
            },
            {
              "id": "1",
              "label": {
                "en": "Don't charge, may discharge",
                "de": "Nicht laden, darf entladen"
              }
            },
            {
              "id": "2",
              "label": {
                "en": "Only surplus charging, don't discharge",
                "de": "Nur Überschussladung, nicht entladen"
              }
            },
            {
              "id": "3",
              "label": {
                "en": "Charge at maximum, may discharge",
                "de": "Ladung auf Maximum, darf entladen"
              }
            },
            {
              "id": "4",
              "label": {
                "en": "Charge at maximum, may not discharge",
                "de": "Ladung auf Maximum, darf nicht entladen"
              }
            }
          ],
          "hint": {
            "en": "Schedule value for cheapest time blocks"
          }
        },
        {
          "id": "min_home_consumption_cheapest",
          "type": "number",
          "label": {
            "en": "Battery Discharge from Grid Consumption (W)",
            "de": "Batterieentladung ab Netzbezug (W)"
          },
          "value": 50,
          "min": 0,
          "max": 10000,
          "hint": {
            "en": "Minimum grid consumption threshold for battery discharge during cheapest price blocks"
          }
        }
      ]
    },
    {
      "type": "group",
      "label": {
        "en": "Standard Blocks",
        "de": "Standard Blöcke"
      },
      "children": [
        {
          "id": "standard_state_value",
          "type": "dropdown",
          "label": {
            "en": "Schedule Value",
            "de": "Zeitplanwert"
          },
          "value": "0",
          "values": [
            {
              "id": "0",
              "label": {
                "en": "No restriction",
                "de": "Keine Einschränkung"
              }
            },
            {
              "id": "1",
              "label": {
                "en": "Don't charge, may discharge",
                "de": "Nicht laden, darf entladen"
              }
            },
            {
              "id": "2",
              "label": {
                "en": "Only surplus charging, don't discharge",
                "de": "Nur Überschussladung, nicht entladen"
              }
            },
            {
              "id": "3",
              "label": {
                "en": "Charge at maximum, may discharge",
                "de": "Ladung auf Maximum, darf entladen"
              }
            },
            {
              "id": "4",
              "label": {
                "en": "Charge at maximum, may not discharge",
                "de": "Ladung auf Maximum, darf nicht entladen"
              }
            }
          ],
          "hint": {
            "en": "Schedule value for standard/default time blocks"
          }
        },
        {
          "id": "min_home_consumption_standard",
          "type": "number",
          "label": {
            "en": "Battery Discharge from Grid Consumption (W)",
            "de": "Batterieentladung ab Netzbezug (W)"
          },
          "value": 50,
          "min": 0,
          "max": 10000,
          "hint": {
            "en": "Minimum grid consumption threshold for battery discharge during standard price blocks"
          }
        }
      ]
    },
    {
      "type": "group",
      "label": {
        "en": "Most Expensive Blocks",
        "de": "Teuerste Blöcke"
      },
      "children": [
        {
          "id": "expensive_blocks_count",
          "type": "number",
          "label": {
            "en": "Number of Blocks",
            "de": "Anzahl der Blöcke"
          },
          "value": 8,
          "min": 0,
          "max": 96,
          "hint": {
            "en": "15-min blocks per day set to avoid grid. Default: 8 = 2 hours"
          }
        },
        {
          "id": "expensive_blocks_value",
          "type": "dropdown",
          "label": {
            "en": "Schedule Value",
            "de": "Zeitplanwert"
          },
          "value": "1",
          "values": [
            {
              "id": "0",
              "label": {
                "en": "No restriction",
                "de": "Keine Einschränkung"
              }
            },
            {
              "id": "1",
              "label": {
                "en": "Don't charge, may discharge",
                "de": "Nicht laden, darf entladen"
              }
            },
            {
              "id": "2",
              "label": {
                "en": "Only surplus charging, don't discharge",
                "de": "Nur Überschussladung, nicht entladen"
              }
            },
            {
              "id": "3",
              "label": {
                "en": "Charge at maximum, may discharge",
                "de": "Ladung auf Maximum, darf entladen"
              }
            },
            {
              "id": "4",
              "label": {
                "en": "Charge at maximum, may not discharge",
                "de": "Ladung auf Maximum, darf nicht entladen"
              }
            }
          ],
          "hint": {
            "en": "Schedule value for most expensive time blocks"
          }
        },
        {
          "id": "min_home_consumption_expensive",
          "type": "number",
          "label": {
            "en": "Battery Discharge from Grid Consumption (W)",
            "de": "Batterieentladung ab Netzbezug (W)"
          },
          "value": 50,
          "min": 0,
          "max": 10000,
          "hint": {
            "en": "Minimum grid consumption threshold for battery discharge during most expensive price blocks"
          }
        }
      ]
    }
  ],
  "pair": [
    {
      "id": "configure"
    },
    {
      "id": "list_devices",
      "template": "list_devices",
      "navigation": {
        "prev": "configure",
        "next": "add_devices"
      }
    },
    {
      "id": "add_devices",
      "template": "add_devices"
    }
  ]
}

